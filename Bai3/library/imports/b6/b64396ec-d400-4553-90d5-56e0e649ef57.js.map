{"version":3,"sources":["assets\\Script\\GameManager.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["// Learn TypeScript:\n//  - https://docs.cocos.com/creator/2.4/manual/en/scripting/typescript.html\n// Learn Attribute:\n//  - https://docs.cocos.com/creator/2.4/manual/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - https://docs.cocos.com/creator/2.4/manual/en/scripting/life-cycle-callbacks.html\n\nconst { ccclass, property } = cc._decorator;\n\n@ccclass\nexport default class GameManager extends cc.Component {\n\n    @property(cc.Prefab)\n    public bullet_Prefab: cc.Prefab = null;\n\n    @property(cc.Prefab)\n    public enemy_Prefab: cc.Prefab = null;\n\n    @property(cc.Node)\n    public fire_Point: cc.Node = null;\n\n    @property(cc.Node)\n    public player: cc.Node = null;\n\n    @property(cc.Node)\n    public enemy: cc.Node = null;\n\n    @property(cc.Node)\n    public enemy_Pos: cc.Node = null;\n\n    private bullet;\n\n    private fire_Point_Position;\n\n    private player_velocity: cc.Vec2;\n    start(): void {\n        this.player_velocity = this.player.getComponent(cc.RigidBody).linearVelocity;\n\n    }\n\n    Fire() {\n        this.bullet = cc.instantiate(this.bullet_Prefab);\n        this.bullet.parent = this.node;\n        this.fire_Point_Position = this.node.convertToNodeSpaceAR(this.fire_Point.parent.convertToWorldSpaceAR(this.fire_Point.position));\n        this.bullet.setPosition(this.fire_Point_Position);\n        this.bullet.rotation = this.player.rotation;\n    }\n\n    seek(target: cc.Vec2): cc.Vec2 {\n        console.log(target.x+\" \"+ target.y);\n        \n        let desired = new cc.Vec2(target.x - this.fire_Point_Position.x, target.y - this.fire_Point_Position.y);\n        let steering = new cc.Vec2();\n        cc.Vec2.subtract(steering, desired, this.player_velocity);\n        return steering;\n    }\n    rotate(target: cc.Vec2) {\n        let desired = new cc.Vec2(target.x - this.fire_Point_Position.x, target.y - this.fire_Point_Position.y);\n        let steering = new cc.Vec2();\n        cc.Vec2.subtract(steering, desired, this.player_velocity);\n        return this.caculated_rotate(desired, steering);\n    }\n    caculated_rotate(Vec1: cc.Vec2, Vec2: cc.Vec2) {\n        return Math.acos((Vec1.x * Vec2.x + Vec1.y * Vec2.y) / (Math.sqrt(Vec1.x * Vec1.x + Vec1.y * Vec1.y) *\n            Math.sqrt(Vec2.x * Vec2.x + Vec2.y * Vec2.y)))\n    }\n\n\n\n    update(dt) {\n        let seek: cc.Vec2;\n        if (this.enemy.activeInHierarchy) {\n            seek = this.seek(this.enemy.getPosition());\n            this.bullet.getComponent(cc.RigidBody).linearVelocity = new cc.Vec2(seek.x, seek.y);\n            this.bullet.rotate += this.rotate(this.enemy.getPosition());\n            console.log(this.rotate(this.enemy.getPosition()));\n            \n        }\n    }\n}\n"]}